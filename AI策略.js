function AI出牌(){if(!(对战信息.我方.当前血量<=0||对战信息.敌方.当前血量<=0))if(可以操作()){let f=对战信息.敌方;var r=[];for(let t=0;t<f.手牌.length;t++){let e=!0;var n=返回卡牌效果(f.手牌[t]);7<=f.场面.length&&"随从"==f.手牌[t].类型&&(e=!1),0==f.场面.length&&"指向友方"==n.指向&&(e=!1),(e=g()&&"指向敌方"==n.指向?!1:e)&&r.push(f.手牌[t])}var e=function(f,e){let i=[],o=0;return function t(r,n,l){if(e<l)return;if(l===e||r===f.length)return void((l>o||l===o&&n.length<i.length)&&(i=n.slice(),o=l));for(let e=r;e<f.length;e++)n.push(f[e].id),l+=f[e].当前费用,t(e+1,n,l),n.pop(),l-=f[e].当前费用}(0,[],0),i}(r,f.水晶);if(e.length<=0){var t=function(e,n){let l=-1/0,f=-1,i=-1,t=function(t,r){let n=0,l=0;for(let e=0;e<t.length;e++){var f=t[e];0<f.攻击次数&&0<f.当前攻击&&0<f.当前血量&&!检测卡牌效果(f,"无法攻击")&&(n+=f.攻击次数*f.当前攻击)}for(let e=0;e<r.length;e++){var i=r[e];0<i.当前血量&&!检测卡牌效果(i,"无法攻击")&&(l+=i.当前攻击*(检测卡牌效果(i,"风怒")?2:1))}return{cg1:n,cg2:l}}(e,n);for(let r=0;r<e.length;r++){var o=e[r];if(0<o.攻击次数&&0<o.当前攻击&&0<o.当前血量){if(g()||t.cg1>=对战信息.我方.当前血量)return{p:o,p2:对战信息.我方};for(let t=0;t<n.length;t++){var u=n[t];if(0<u.当前血量){let e=0;o.当前攻击>=u.当前血量||检测卡牌效果(o,"剧毒")?e+=h(u):e+=o.当前攻击,u.当前攻击>=o.当前血量||检测卡牌效果(o,"剧毒")?e-=h(o):e-=u.当前攻击,e>l&&(l=e,f=r,i=t)}}}}return-1!=f&&-1!=i&&((l<0||l<=e[f].当前攻击-n[i].当前攻击||对战信息.我方.当前血量<=e[f].当前攻击)&&t.cg2<对战信息.敌方.当前血量?{p:e[f],p2:对战信息.我方}:{p:e[f],p2:n[i]})}(f.场面,对战信息.我方.场面);t?(随从攻击(t.p,t.p2),AI出牌()):setTimeout(回合交替,sj(300,500))}else{var l=e[0];for(let e=0;e<f.手牌.length;e++){var i=f.手牌[e];if(i.id==l){switch(i.类型){case"随从":使用卡牌(i,f,0,e);break;case"法术":var o=返回卡牌效果(i);"指向敌方"==o.指向&&使用卡牌(i,f,u(!1),e),"指向友方"==o.指向&&使用卡牌(i,f,u(),e),o.指向||使用卡牌(i,f,-1,e)}return void AI出牌()}}}function g(){for(let e=0;e<对战信息.我方.场面.length;e++)if(0<对战信息.我方.场面[e].当前血量)return;return 1}function h(r){let n=r.当前血量+r.当前攻击;检测卡牌效果(r,"风怒")&&(n+=r.当前攻击),检测卡牌效果(r,"吸血")&&(n+=r.当前攻击),检测卡牌效果(r,"无法攻击")&&(n-=r.当前攻击);for(let t=0;t<r.效果.length;t++)for(let e=0;e<卡牌效果.length;e++)if(r.效果[t].名称==卡牌效果[e].名称&&卡牌效果[e].加分){n+=卡牌效果[e].加分;break}return n}function u(e=!0){if(e){let t=-1/0,r=f.场面[0];for(let e=0;e<f.场面.length;e++){var n=h(f.场面[e]);n>t&&(t=n,r=f.场面[e])}return r}{let t=-1/0,r=对战信息.我方.场面[0];for(let e=0;e<对战信息.我方.场面.length;e++){var l=h(对战信息.我方.场面[e]);l>t&&(t=l,r=对战信息.我方.场面[e])}return r}}}else setTimeout(AI出牌,sj(1500,2e3))}